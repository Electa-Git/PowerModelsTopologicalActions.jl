%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%                                                                  			 	  %%%%%
%%%%    IEEE PES Power Grid Library - Optimal Power Flow with HVDC Lines - vXX.XX     %%%%%
%%%%          (https://github.com/power-grid-lib/pglib-opf-hvdc)      				  %%%%%
%%%%               Benchmark Group - Typical Operations               				  %%%%%
%%%%                         DD - Month - YYY                       				  %%%%%
%%%%                                                                  				  %%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   AC/DC grid OPF test case based on:
%
%
%   Copyright (c) 2023 by Oscar Damanik, Giacomo Bastianel, Stephen Hardy ({oscar.damanik, giacomo.bastianel}@kuleuven.be, stephen.hardy@enersynt.com)
%   Licensed under the Creative Commons Attribution 4.0
%   International license, http://creativecommons.org/licenses/by/4.0/
%

function mpc = dcoverlay
mpc.version = '2';
mpc.baseMVA = 100.0;
mpc.variant = 'max_load_res_ratio'

%% bus data
%	bus_i	type		Pd		Qd		  Gs	 Bs	   area		Vm	   Va		   baseKV	zone	  Vmax			 Vmin
mpc.bus = [
	1	 	2	 		52446.56989139992	 	0	 	  0.0	 0.0	 1	    1.0	    0	 		380.0	  1	      1.10000	    0.90000;
	2	 	2	 		70044.7537152	 	0	 	  0.0	 0.0	 1	    1.0	    0	 		380.0	  1	      1.10000	    0.90000;
	3	 	3	 		121966.2403533	 	0	 	  0.0	 0.0	 1	    1.0	    0	 		380.0	  1	      1.10000	    0.90000;
	4	 	2	 		113101.1652744	 	0	 	  0.0	 0.0	 1	    1.0	    0	 		380.0	  1	      1.10000	    0.90000;
	5	 	2	 		158823.2186231391	 	0	 	  0.0	 0.0	 1	    1.0	    0	 		380.0	  1	      1.10000	    0.90000;
	6	 	2	 		72309.5685576	 	0	 	  0.0	 0.0	 1	    1.0	    0	 		380.0	  1	      1.10000	    0.90000;
];

%% generator data
%	bus	   Pg	  Qg		Qmax		 Qmin	  Vg	   mBase	status		Pmax	  Pmin	 Pc1	 Pc2   Qc1min	Qc1max    Qc2min	Qc2max	ramp_agc	    ramp_10	      ramp_30	  ramp_q	   apf         alpha
mpc.gen = [
1	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
1	0	0	7318.87	-1983.92	1.05	100	1	14637.73178	0	0	0	0	0	0	0	0	0	0	0	0	1;
1	0	0	12130.7	-2725.07	1.05	100	1	24261.4049	0	0	0	0	0	0	0	0	0	0	0	0	1;
1	0	0	11000	-11000	1.05	100	1	22000	0	0	0	0	0	0	0	0	0	0	0	0	1;
2	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
2	0	0	3761.1	-259.557	1.05	100	1	7522.198414	0	0	0	0	0	0	0	0	0	0	0	0	1;
2	0	0	507.584	-57.2537	1.05	100	1	1015.168644	0	0	0	0	0	0	0	0	0	0	0	0	1;
2	0	0	26000	-26000	1.05	100	1	52000	0	0	0	0	0	0	0	0	0	0	0	0	1;
3	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
3	0	0	8478.82	-729.852	1.05	100	1	16957.64595	0	0	0	0	0	0	0	0	0	0	0	0	1;
3	0	0	10082.2	-968.098	1.05	100	1	20164.35443	0	0	0	0	0	0	0	0	0	0	0	0	1;
3	0	0	54500	-54500	1.05	100	1	109000	0	0	0	0	0	0	0	0	0	0	0	0	1;
4	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
4	0	0	5743.79	-302.671	1.05	100	1	11487.57983	0	0	0	0	0	0	0	0	0	0	0	0	1;
4	0	0	2423.93	-470.034	1.05	100	1	4847.853287	0	0	0	0	0	0	0	0	0	0	0	0	1;
4	0	0	43000	-43000	1.05	100	1	86000	0	0	0	0	0	0	0	0	0	0	0	0	1;
5	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
5	0	0	4126.14	-252.222	1.05	100	1	8252.271759	0	0	0	0	0	0	0	0	0	0	0	0	1;
5	0	0	179.703	-16.1465	1.05	100	1	359.4051038	0	0	0	0	0	0	0	0	0	0	0	0	1;
5	0	0	76000	-76000	1.05	100	1	152000	0	0	0	0	0	0	0	0	0	0	0	0	1;
6	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
6	0	0	8983.72	-1834.26	1.05	100	1	17967.44411	0	0	0	0	0	0	0	0	0	0	0	0	1;
6	0	0	2379.93	-596.217	1.05	100	1	4759.8591	0	0	0	0	0	0	0	0	0	0	0	0	1;
6	0	0	31000	-31000	1.05	100	1	62000	0	0	0	0	0	0	0	0	0	0	0	0	1;
1	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
2	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
3	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
4	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
5	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
6	0	0	0	0	1.05	100	1	0	0	0	0	0	0	0	0	0	0	0	0	0	1;
];

%% branch data
%	fbus	tbus	r			 x			 b				  rateA	   rateB	   rateC	 ratio	  angle	    status	angmin	    angmax
mpc.branch = [
	3	 	4	 	0.0033204062788550325   0.019518120960295475	 8.809578281095095e-5 	  2700.0	   2700.0 	   2700.0 	 0.0	  0.0	    1	 	-60.0	 	60.0;
	3	 	5	 	0.00385595567867036   0.02266620498614958	 7.58602574205411e-5 	  2700.0	   2700.0 	   2700.0 	 0.0	  0.0	    1	 	-60.0	 	60.0;
	3	 	6	 	0.0011964017774699907   0.0076682248384118195	 0.0002243106796116505 	  5800.0	   5800.0 	   5800.0 	 0.0	  0.0	    1	 	-60.0	 	60.0;
];

%% dc grid topology
%column_names% dcpoles
mpc.dcpol=2;
% numbers of poles (1=monopolar grid, 2=bipolar grid)
%% bus data
%column_names%  busdc_i    grid    Pdc     Vdc   basekVdc    Vdcmax   Vdcmin   Cdc  area
mpc.busdc = [
    			1       1       0       1       525       1.1     0.9     0	  1;
    			2       1       0       1       525       1.1     0.9     0	  1;
				3       1       0       1       525       1.1     0.9     0	  1;
				4       1       0       1       525       1.1     0.9     0	  1;
				5       1       0       1       525       1.1     0.9     0	  1;
				6       1       0       1       525       1.1     0.9     0	  1;
				7       1       0       1       525       1.1     0.9     0	  1;
				8       1       0       1       525       1.1     0.9     0   1;
				9       1       0       1       525       1.1     0.9     0	  1;
				10       1       0       1       525       1.1     0.9     0   1;
				11       1       0       1       525       1.1     0.9     0	  1;
				12       1       0       1       525       1.1     0.9     0   1;
				13       1       0       1       525       1.1     0.9     0	  1;
				14       1       0       1       525       1.1     0.9     0	  1;
];

%% converters
%column_names%  busdc_i	busac_i	type_dc	type_ac	P_g	Q_g	islcc	Vtar	rtf	xtf	transformer	tm	bf	filter	rc	xc	reactor	basekVac	Vmmax	Vmmin	Imax	status	LossA	LossB	LossCrec	LossCinv	droop	Pdcset	Vdcset	dVdcset	Pacmax	Pacmin	Qacmax	Qacmin	ratio	index	Pacrated	Qacrated	conv_id	type_link
mpc.convdc = [
1	1	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	1	6000	0	1	2	;
2	2	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	2	6000	0	2	2	;
3	3	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	3	6000	0	3	2	;
4	4	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	4	6000	0	4	2	;
5	5	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	5	6000	0	5	2	;
6	6	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	6	6000	0	6	2	;
4	4	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	8	6000	0	8	2	;
4	4	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	9	6000	0	9	2	;
4	4	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	10	6000	0	10	2	;
4	4	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	11	6000	0	11	2	;
1	1	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	12	6000	0	12	2	;
5	5	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	13	6000	0	13	2	;
5	5	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	14	6000	0	14	2	;
5	5	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	15	6000	0	15	2	;
2	2	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	16	6000	0	16	2	;
6	6	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	17	6000	0	17	2	;
3	3	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	18	6000	0	18	2	;
3	3	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	19	6000	0	19	2	;
3	3	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	20	6000	0	20	2	;
3	3	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	21	6000	0	21	2	;
3	3	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	22	6000	0	22	2	;
7	1	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	23	6000	0	23	1	;
9	1	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	6000	-6000	0	0	0	24	6000	0	24	1	;
11	1	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	3000	-3000	0	0	0	25	3000	0	25	1	;
12	2	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	3000	-3000	0	0	0	26	3000	0	26	1	;
13	2	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	3000	-3000	0	0	0	27	3000	0	27	1	;
10	3	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	3000	-3000	0	0	0	28	3000	0	28	1	;
14	3	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	3000	-3000	0	0	0	29	3000	0	29	1	;
8	4	1	1	-60	-40	0	1	7.13994E-05	0.00249898	0	1	13.608978	0	4.16435E-05	0.001249306	0	345	1.1	0.9	11180.33989	1	1.103	0.887	2.885	2.885	0.005	-0.586274	1.0079	0	3000	-3000	0	0	0	30	3000	0	30	1	;
];

%% branches
%column_names%  fbusdc  tbusdc  r        l   c   rateA   rateB   rateC   status dcpoles
mpc.branchdc = [
     			1       3       0.00133667   0   0   750    750    750     1		2;
    			1       4       5.27632e-5   0   0   10000    10000    10000     1		2;
    		    2       3       0.000136483   0   0   8000    8000    8000     1		2;
				3       4       8.17829e-5   0   0   10000    10000    10000     1		2;
				3       5       0.000144511   0   0   8000    8000    8000     1		2;
				3       6       6.5954e-5   0   0   10000    10000    10000     1		2;
				4       5       9.23356e-5   0   0   10000    10000    10000     1		2;
				5       6       0.002005  0   0   500    500    500     1		2;
				7       8       0.00142012   0   0   3000    3000    3000     1		2;
				11		12       0.000899408   0   0   3000    3000    3000     1		2;
				9       10       0.000473373   0   0   3000    3000    3000     1		2;
				13      14       0.000804733   0   0   3000    3000    3000     1		2;
 ];

%% generator cost data
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	0	0	2	0	0;
	2	0	0	2	25	0;
	2	0	0	2	50	0;
	2	0	0	2	113.482707	0;
	2	0	0	2	0	0;
	2	0	0	2	25	0;
	2	0	0	2	50	0;
	2	0	0	2	182.04491	0;
	2	0	0	2	0	0;
	2	0	0	2	25	0;
	2	0	0	2	50	0;
	2	0	0	2	132.85551	0;
	2	0	0	2	0	0;
	2	0	0	2	25	0;
	2	0	0	2	50	0;
	2	0	0	2	169.23671	0;
	2	0	0	2	0	0;
	2	0	0	2	25	0;
	2	0	0	2	50	0;
	2	0	0	2	284.427749	0;
	2	0	0	2	0	0;
	2	0	0	2	25	0;
	2	0	0	2	50	0;
	2	0	0	2	131.816167	0;
	2	0	0	2	513.4827079	0;
	2	0	0	2	582.044913	0;
	2	0	0	2	532.855514	0;
	2	0	0	2	569.2367104	0;
	2	0	0	2	684.427749	0;
	2	0	0	2	531.816167	0;
];

%% generator data
%column_names%	type
mpc.othergen = [
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
1	;
];